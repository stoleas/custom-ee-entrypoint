---
version: 3
images:
  base_image:
    name: docker.io/redhat/ubi9:latest
dependencies:
  ansible_core:
    package_pip: ansible-core
  ansible_runner:
    package_pip: ansible-runner
additional_build_steps:
  prepend_base:
    - RUN mkdir -p /runner/validation
    - COPY pre-check.yml /runner/validation/pre-check.yml
    - COPY pre-check.sh /runner/validation/pre-check.sh
    - RUN chmod 755 /runner/validation/pre-check.sh
  append_final:
    - RUN sed -i '/exec "${@}"/i /runner/validation/pre-check.sh' /opt/builder/bin/entrypoint
